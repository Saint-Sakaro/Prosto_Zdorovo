# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: –ê–Ω–∞–ª–∏–∑ –æ—Ç–∑—ã–≤–æ–≤ —á–µ—Ä–µ–∑ LLM

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

‚úÖ **–í—Ç–æ—Ä–æ–π —Ä–µ–π—Ç–∏–Ω–≥** - LLM –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ –æ—Ç–∑—ã–≤—ã —Ç–æ—á–∫–∏ –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ–±—ä–µ–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ 0-5  
‚úÖ **–ö—Ä–∞—Ç–∫–∏–π –æ—Ç—á–µ—Ç** - LLM –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á–µ—Ç –æ –∑–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –æ—Ç–∑—ã–≤–æ–≤  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–¥–æ–±—Ä–µ–Ω–∏–∏ –æ—Ç–∑—ã–≤–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è LLM —Ä–µ–π—Ç–∏–Ω–≥

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –æ—Ç–∑—ã–≤** –æ –∑–∞–≤–µ–¥–µ–Ω–∏–∏
2. **–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –æ–¥–æ–±—Ä—è–µ—Ç –æ—Ç–∑—ã–≤** (`moderation_status='approved'`)
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∑–∞–¥–∞—á–∞** `update_poi_llm_rating`
4. **LLM –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ –æ–¥–æ–±—Ä–µ–Ω–Ω—ã–µ –æ—Ç–∑—ã–≤—ã** —Ç–æ—á–∫–∏
5. **–§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≤—Ç–æ—Ä–æ–π —Ä–µ–π—Ç–∏–Ω–≥** –∏ –∫—Ä–∞—Ç–∫–∏–π –æ—Ç—á–µ—Ç
6. **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** –≤ `poi.llm_rating` –∏ `poi.llm_report`

## –ú–∏–≥—Ä–∞—Ü–∏–∏:

```bash
python3 manage.py makemigrations maps
python3 manage.py migrate maps
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

### –ü–æ–ª—É—á–∏—Ç—å LLM —Ä–µ–π—Ç–∏–Ω–≥ —á–µ—Ä–µ–∑ API:
```bash
GET /api/maps/pois/{uuid}/

# –û—Ç–≤–µ—Ç –≤–∫–ª—é—á–∞–µ—Ç:
{
  "llm_rating": 4.2,
  "llm_report": "–ö—Ä–∞—Ç–∫–∏–π –æ—Ç—á–µ—Ç –æ –∑–∞–≤–µ–¥–µ–Ω–∏–∏...",
  "llm_analyzed_at": "2025-12-07T10:00:00Z"
}
```

### –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞:
```python
from maps.tasks_ratings import update_poi_llm_rating
update_poi_llm_rating.delay(poi.id)
```

### –ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö POI:
```python
from maps.tasks_ratings import update_all_pois_llm_ratings
update_all_pois_llm_ratings.delay()
```

## –í–∞–∂–Ω–æ:

- ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç—Å—è Celery** –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á
- ‚ö†Ô∏è **–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–æ–±—Ä–µ–Ω–Ω—ã–µ –æ—Ç–∑—ã–≤—ã** (`moderation_status='approved'`)
- ‚ö†Ô∏è **–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ—Ç–∑—ã–≤—ã —Ç–∏–ø–∞ `poi_review`** (–Ω–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã)
- ‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–¥–æ–±—Ä–µ–Ω–∏–∏ –æ—Ç–∑—ã–≤–æ–≤

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:

### POI –º–æ–¥–µ–ª—å:
- `llm_rating` - Float (0-5), –≤—Ç–æ—Ä–æ–π —Ä–µ–π—Ç–∏–Ω–≥ –Ω–∞ –æ—Å–Ω–æ–≤–µ LLM –∞–Ω–∞–ª–∏–∑–∞
- `llm_report` - Text, –∫—Ä–∞—Ç–∫–∏–π –æ—Ç—á–µ—Ç –∑–∞–≤–µ–¥–µ–Ω–∏—è
- `llm_analyzed_at` - DateTime, –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

### –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞:
```python
{
    'llm_rating': 4.2,  # –†–µ–π—Ç–∏–Ω–≥ 0-5
    'confidence': 0.85,  # –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å 0-1
    'analysis_summary': '–ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ...',
    'key_points': ['–ú–æ–º–µ–Ω—Ç 1', '–ú–æ–º–µ–Ω—Ç 2'],
    'sentiment_distribution': {
        'positive': 10,
        'neutral': 2,
        'negative': 1
    }
}
```
