#!/usr/bin/env python
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ—Ç–∑—ã–≤–æ–≤ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –ú–æ—Å–∫–≤—ã –¥–ª—è –∫–∞—Ä—Ç—ã
"""

import os
import django
from django.utils import timezone
import random

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'health_map.settings')
django.setup()

from django.contrib.auth.models import User
from gamification.models import Review
from gamification.utils import get_or_create_user_profile

def add_map_reviews():
    """–î–æ–±–∞–≤–ª—è–µ—Ç –æ—Ç–∑—ã–≤—ã —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –ú–æ—Å–∫–≤—ã –¥–ª—è –∫–∞—Ä—Ç—ã"""
    
    print("=" * 60)
    print("–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤ –Ω–∞ –∫–∞—Ä—Ç—É –ú–æ—Å–∫–≤—ã")
    print("=" * 60)
    
    # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Å—Ç –≤ –ú–æ—Å–∫–≤–µ
    MOSCOW_PLACES = [
        # –¶–µ–Ω—Ç—Ä –ú–æ—Å–∫–≤—ã
        {'name': '–ö—Ä–∞—Å–Ω–∞—è –ø–ª–æ—â–∞–¥—å', 'lat': 55.7558, 'lon': 37.6173, 'category': '–î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å'},
        {'name': '–ö—Ä–µ–º–ª—å', 'lat': 55.7520, 'lon': 37.6156, 'category': '–î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å'},
        {'name': '–ì–£–ú', 'lat': 55.7547, 'lon': 37.6206, 'category': '–ú–∞–≥–∞–∑–∏–Ω'},
        {'name': '–ë–æ–ª—å—à–æ–π —Ç–µ–∞—Ç—Ä', 'lat': 55.7596, 'lon': 37.6184, 'category': '–ö—É–ª—å—Ç—É—Ä–∞'},
        {'name': '–¢—Ä–µ—Ç—å—è–∫–æ–≤—Å–∫–∞—è –≥–∞–ª–µ—Ä–µ—è', 'lat': 55.7415, 'lon': 37.6208, 'category': '–ú—É–∑–µ–π'},
        
        # –ü–∞—Ä–∫–∏
        {'name': '–ü–∞—Ä–∫ –ì–æ—Ä—å–∫–æ–≥–æ', 'lat': 55.7317, 'lon': 37.6053, 'category': '–ü–∞—Ä–∫'},
        {'name': '–í–î–ù–•', 'lat': 55.8304, 'lon': 37.6310, 'category': '–î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å'},
        {'name': '–°–æ–∫–æ–ª—å–Ω–∏–∫–∏', 'lat': 55.7930, 'lon': 37.6792, 'category': '–ü–∞—Ä–∫'},
        {'name': '–ö–æ–ª–æ–º–µ–Ω—Å–∫–æ–µ', 'lat': 55.6672, 'lon': 37.6694, 'category': '–ü–∞—Ä–∫'},
        
        # –ú–µ–¥–∏—Ü–∏–Ω–∞
        {'name': '–ì–æ—Ä–æ–¥—Å–∫–∞—è –±–æ–ª—å–Ω–∏—Ü–∞ ‚Ññ1', 'lat': 55.7525, 'lon': 37.6210, 'category': '–ú–µ–¥–∏—Ü–∏–Ω–∞'},
        {'name': '–ü–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∞ ‚Ññ2', 'lat': 55.7615, 'lon': 37.6280, 'category': '–ü–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∞'},
        {'name': '–ö–ª–∏–Ω–∏–∫–∞ "–ó–¥–æ—Ä–æ–≤—å–µ"', 'lat': 55.7480, 'lon': 37.6150, 'category': '–ö–ª–∏–Ω–∏–∫–∞'},
        
        # –ê–ø—Ç–µ–∫–∏
        {'name': '–ê–ø—Ç–µ–∫–∞ ‚Ññ36', 'lat': 55.7580, 'lon': 37.6250, 'category': '–ê–ø—Ç–µ–∫–∞'},
        {'name': '–ê–ø—Ç–µ–∫–∞ "–†–∏–≥–ª–∞"', 'lat': 55.7630, 'lon': 37.6320, 'category': '–ê–ø—Ç–µ–∫–∞'},
        
        # –°–ø–æ—Ä—Ç
        {'name': '–§–∏—Ç–Ω–µ—Å-–∫–ª—É–± "World Class"', 'lat': 55.7550, 'lon': 37.6220, 'category': '–°–ø–æ—Ä—Ç'},
        {'name': '–°–ø–æ—Ä—Ç–∑–∞–ª "–§–∏—Ç–Ω–µ—Å-–º–∞—Å—Ç–µ—Ä"', 'lat': 55.7600, 'lon': 37.6350, 'category': '–°–ø–æ—Ä—Ç'},
        {'name': '–ë–∞—Å—Å–µ–π–Ω "–û–ª–∏–º–ø–∏–π—Å–∫–∏–π"', 'lat': 55.7818, 'lon': 37.6219, 'category': '–°–ø–æ—Ä—Ç'},
        
        # –ö–∞—Ñ–µ –∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã
        {'name': '–ö–∞—Ñ–µ "–ó–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ"', 'lat': 55.7530, 'lon': 37.6180, 'category': '–ö–∞—Ñ–µ'},
        {'name': '–†–µ—Å—Ç–æ—Ä–∞–Ω "Veggie"', 'lat': 55.7570, 'lon': 37.6260, 'category': '–†–µ—Å—Ç–æ—Ä–∞–Ω'},
        {'name': '–°–º—É–∑–∏-–±–∞—Ä', 'lat': 55.7500, 'lon': 37.6140, 'category': '–ö–∞—Ñ–µ'},
        
        # –ú–∞–≥–∞–∑–∏–Ω—ã –∑–¥–æ—Ä–æ–≤–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è
        {'name': '–ú–∞–≥–∞–∑–∏–Ω "–í–∫—É—Å–í–∏–ª–ª"', 'lat': 55.7640, 'lon': 37.6300, 'category': '–ú–∞–≥–∞–∑–∏–Ω'},
        {'name': '–≠–∫–æ-–º–∞—Ä–∫–µ—Ç', 'lat': 55.7490, 'lon': 37.6160, 'category': '–ú–∞–≥–∞–∑–∏–Ω'},
        
        # –ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã (–ø—Ä–æ–±–ª–µ–º—ã –≤ –≥–æ—Ä–æ–¥–µ)
        {'name': '–Ø–º–∞ –Ω–∞ –¥–æ—Ä–æ–≥–µ', 'lat': 55.7515, 'lon': 37.6175, 'category': '–ò–Ω—Ü–∏–¥–µ–Ω—Ç'},
        {'name': '–†–∞–∑–±–∏—Ç–∞—è —Ç—Ä–æ—Ç—É–∞—Ä–Ω–∞—è –ø–ª–∏—Ç–∫–∞', 'lat': 55.7560, 'lon': 37.6230, 'category': '–ò–Ω—Ü–∏–¥–µ–Ω—Ç'},
        {'name': '–ù–µ—É–±—Ä–∞–Ω–Ω—ã–π –º—É—Å–æ—Ä', 'lat': 55.7585, 'lon': 37.6285, 'category': '–ò–Ω—Ü–∏–¥–µ–Ω—Ç'},
    ]
    
    # –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    users = list(User.objects.all()[:5])
    if not users:
        print("‚ö†Ô∏è  –ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π! –°–æ–∑–¥–∞–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.")
        return
    
    review_types = ['poi_review', 'incident']
    statuses = ['pending', 'approved', 'approved', 'approved']  # –ë–æ–ª—å—à–µ approved –¥–ª—è –≤–∏–¥–∏–º–æ—Å—Ç–∏
    
    print(f"\nüìç –°–æ–∑–¥–∞–Ω–∏–µ {len(MOSCOW_PLACES)} –æ—Ç–∑—ã–≤–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ –ú–æ—Å–∫–≤—ã...\n")
    
    created_count = 0
    for i, place in enumerate(MOSCOW_PLACES):
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –æ—Ç–∑—ã–≤–∞ (–∏–Ω—Ü–∏–¥–µ–Ω—Ç –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π)
        review_type = 'incident' if place['category'] == '–ò–Ω—Ü–∏–¥–µ–Ω—Ç' else 'poi_review'
        
        # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        user = random.choice(users)
        
        # –í—ã–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ç—É—Å (–±–æ–ª—å—à–µ approved –¥–ª—è –≤–∏–¥–∏–º–æ—Å—Ç–∏)
        status = statuses[i % len(statuses)]
        
        # –°–æ–∑–¥–∞–µ–º –æ—Ç–∑—ã–≤
        review = Review.objects.create(
            author=user,
            review_type=review_type,
            latitude=place['lat'],
            longitude=place['lon'],
            category=place['category'],
            content=f"–û—Ç–∑—ã–≤ –æ –º–µ—Å—Ç–µ: {place['name']}. " +
                   (f"–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω –∏–Ω—Ü–∏–¥–µ–Ω—Ç: {place['name']}. " if review_type == 'incident' else
                    f"–û—Ç–∑—ã–≤ –æ –º–µ—Å—Ç–µ {place['name']}. ") +
                   f"–ö–∞—Ç–µ–≥–æ—Ä–∏—è: {place['category']}. –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: {place['lat']}, {place['lon']}",
            has_media=random.choice([True, False]),
            is_unique=random.choice([True, False]),
            moderation_status=status
        )
        
        created_count += 1
        marker = 'üìç' if review_type == 'poi_review' else '‚ö†Ô∏è'
        print(f"   {marker} {created_count}. {place['name']} ({place['category']}) - {status}")
    
    print("\n" + "=" * 60)
    print(f"‚úÖ –°–æ–∑–¥–∞–Ω–æ –æ—Ç–∑—ã–≤–æ–≤: {created_count}")
    print(f"üìä –í—Å–µ–≥–æ –æ—Ç–∑—ã–≤–æ–≤ –≤ –±–∞–∑–µ: {Review.objects.count()}")
    print("\nüìç –û—Ç–∑—ã–≤—ã —Ä–∞–∑–º–µ—â–µ–Ω—ã –Ω–∞ –∫–∞—Ä—Ç–µ –ú–æ—Å–∫–≤—ã!")
    print("   –û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞—Ä—Ç—É –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤—Å–µ –º–µ—Ç–∫–∏.")
    print("=" * 60)

if __name__ == '__main__':
    add_map_reviews()

